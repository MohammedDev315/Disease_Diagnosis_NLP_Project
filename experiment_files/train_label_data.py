#%%
import pandas as pd
import re
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.linear_model import LogisticRegression

#%%
file_path = "/Volumes/Lexar/DataScience/Disease_Diagnosis_NLP_Project/experiment_files/Data/diseases_with_description.csv"
df = pd.read_csv(file_path , names=["Label", "Disease"])
print(df.head())

##########################
###   Pre-Processing   ###
##########################

#%%

domain_stop_word = [
'i', 'me', 'my', 'myself', 'we', 'our', 'ours', 'ourselves', 'you', "you're",
    "you've", "you'll", "you'd", 'your', 'yours', 'yourself', 'yourselves', 'he',
    'him', 'his', 'himself', 'she', "she's", 'her', 'hers', 'herself', 'it',
    "it's", 'its', 'itself', 'they', 'them', 'their', 'theirs', 'themselves',
    'what', 'which', 'who', 'whom', 'this', 'that', "that'll", 'these', 'those',
    'am', 'is', 'are', 'was', 'were', 'be', 'been', 'being', 'have', 'has', 'had',
    'having', 'do', 'does', 'did', 'doing', 'a', 'an', 'the', 'and', 'but', 'if',
    'or', 'because', 'as', 'until', 'while', 'of', 'at', 'by', 'for', 'with', 'about',
    'against', 'between', 'into', 'through', 'during', 'before', 'after', 'above',
    'below', 'to', 'from', 'up', 'down', 'in', 'out', 'on', 'off', 'over', 'under',
    'again', 'further', 'then', 'once', 'here', 'there', 'when', 'where', 'why',
    'how', 'all', 'any', 'both', 'each', 'few', 'more', 'most', 'other', 'some',
    'such', 'no', 'nor', 'not', 'only', 'own', 'same', 'so', 'than', 'too', 'very',
    's', 't', 'can', 'will', 'just', 'don', "don't", 'should', "should've", 'now',
    'd', 'll', 'm', 'o', 're', 've', 'y', 'ain', 'aren', "aren't", 'couldn',
    "couldn't", 'didn', "didn't", 'doesn', "doesn't", 'hadn', "hadn't", 'hasn',
    "hasn't", 'haven', "haven't", 'isn', "isn't", 'ma', 'mightn', "mightn't",
    'mustn', "mustn't", 'needn', "needn't", 'shan', "shan't", 'shouldn', "shouldn't",
    'wasn', "wasn't", 'weren', "weren't", 'won', "won't", 'wouldn', "wouldn't",
    'antibiotic', 'fiberoptic', 'retinal', 'thin', 'ulcerated', 'antinuclear', 'patchy',
    'lactic', 'thicken', 'axis', 'clinical', 'proper', 'rotary', 'slender', 'dental',
    'pathogenic', 'uncomfortable', 'hyaline', 'somatic', 'firm', 'antiarrhythmic',
    'preoperative', 'latent', 'ruptured', 'usual', 'cryptogenic', 'noninvasive',
    'prosthetic', 'cytoplasmic', 'oral', 'nonventilated', 'dense', 'fingerless',
    'bronchogenic', 'diaphragm', 'septal', 'vesicular', 'impairs', 'highest',
    'intracellular', 'abscess', 'personal', 'experienced', 'vigorous', 'postural',
    'myoglobin', 'relaxed', 'crowded', 'psychogenic', 'oscillatory', 'impaired',
    'calm', 'viscous', 'drive', 'avascular', 'dormant', 'subjective', 'pneumothorax',
    'alone', 'vertebra', 'celiac', 'extensive', 'dry', 'extra', 'minimal', 'sound',
    'rigorous', 'lentil', 'eventual', 'individual', 'peritoneal', 'purulent',
    'hysterical', 'operative', 'earlier', 'anteroposterior', 'walled', 'serotonin',
    'biomechanical', 'dislocate', 'cardiovascular', 'sedative', 'unremitting',
    'automatic', 'sag', 'pseudohypertrophic', 'nearby', 'optic', 'intimal', 'wet',
    'electrolyte', 'diabetic', 'ferruginous', 'tight', 'zoledronic', 'corrosive',
    'gout', 'porous', 'responsive', 'accurate', 'pectoriloquy', 'average',
    'arteriolar', 'unable', 'uric', 'idiopathic', 'angular', 'physiologic', 'typical',
    'twisted', 'extravascular', 'uncompensated', 'causative', 'hypothalamic',
    'clavicular', 'korean', 'osteoporotic', 'preventive', 'natural', 'fibrinolytic',
    'caseationšthe', 'metastatic', 'shallow', 'derivative', 'worn', 'arthropathy',
    'perihilar', 'afferent', 'transtracheal', 'hyperplastic', 'ph', 'prior', 'ptt',
    'segmental', 'many', 'hemodynamic', 'unilateral', 'pernicious', 'anorexic',
    'ateleactactic', 'little', 'extrinsic', 'kyphotic', 'minute', 'sigh', 'mechanical',
    'asymmetrical', 'underwater', 'initiate', 'intercritical', 'visible', 'fibroblastic', 'keen', 'watery', 'voluntary', 'sided', 'genetic', 'thrombolytic', 'cortical', 'old', 'vague', 'antiviral', 'prone', 'intracranial', 'forceful', 'colorless', 'useful', 'vertigo', 'prenatal', 'shuntsšsuch', 'undergone', 'half', 'various', 'supplement', 'cystic', 'lymphaticšbilateral', 'irreversible', 'cnsšcranial', 'insensitive', 'dissecting', 'right', 'cytologic', 'peribronchiolar', 'biochemical', 'chalky', 'serious', 'carpal', 'protect', 'red', 'tonal', 'explosive', 'secure', 'myxoma', 'carbamazepine', 'adenopathy', 'gown', 'neglected', 'intense', 'persist', 'urge', 'diagnostic', 'distinguish', 'musculoskeletal', 'white', 'polyarticular', 'assistive', 'involuntary', 'orderly', 'concurrent', 'native', 'intermittent', 'endemic', 'ulnar', 'fracture', 'deficient', 'productive', 'bilateral', 'metrizamide', 'hereditary', 'twin', 'hilar', 'staple', 'contiguous', 'psychological', 'negative', 'full', 'pleural', 'relentless', 'retinacular', 'unstable', 'exudative', 'serial', 'paratracheal', 'specialized', 'umbilical', 'sarcoplasmic', 'displacement', 'musical', 'diminish', 'extreme', 'antitubercular', 'hydrostatic', 'atrial', 'restrictive', 'anterior', 'rheumatic', 'adjunctive', 'bronchiolar', 'loose', 'elicit', 'correctable', 'rom', 'sequential', 'loosen', 'vocational', 'physical', 'cautious', 'simple', 'early', 'subdeltoid', 'mesenteric', 'related', 'pneumonia', 'transbronchial', 'numb', 'eskimo', 'supplemental', 'longitudinal', 'compact', 'numerous', 'predominant', 'anxious', 'everyday', 'repetitive', 'best', 'superior', 'pleurisy', 'ﬁshaggyﬂ', 'young', 'disturbed', 'radiant', 'passive', 'rapidly', 'several', 'strong', 'lifelong', 'bellow', 'lactose', 'eventful', 'murmur', 'cardiogenic', 'callus', 'neuralgic', 'microbial', 'autonomic', 'talus', 'nodule', 'pcr', 'deviate', 'required', 'pyrophosphate', 'unaccustomed', 'peribronchial', 'hypermetabolic', 'danish', 'peep', 'paralytic', 'embryonic', 'confinement', 'mediastinitis', 'hematogenous', 'antitussive', 'swelling', 'arthritic', 'substantial', 'pituitary', 'suggestive', 'rhythmic', 'inflammatory', 'periodic', 'metatarsophalangeal', 'inferior', 'indirect', 'molecular', 'arch', 'fibroblast', 'fit', 'nasolabial', 'bronchoalveolar', 'mitral', 'shy', 'controversial', 'madappa', 'discrete', 'microscopic', 'entire', 'sexual', 'interphalangeal', 'lobar', 'crepitant', 'unchanged', 'consecutive', 'alternative', 'hypertrophic', 'safe', 'injudicious', 'clammy', 'emphysematous', 'autosomal', 'important', 'internal', 'comparable', 'hyaluronic', 'spontaneous', 'soiled', 'dominant', 'thicker', 'anteriorœposterior', 'potent', 'irritate', 'supple', 'regional', 'distinct', 'thoracolumbar', 'resistant', 'haversian', 'weakened', 'miliary', 'green', 'satisfactory', 'occipital', 'female', 'necrotic', 'creaky', 'ige', 'crumb', 'tall', 'forward', 'fold', 'hepatic', 'detectable', 'flecked', 'supervised', 'noncompliant', 'swollen', 'fulminant', 'nonfunctional', 'dark', 'worsens', 'grazel', 'nodular', 'unsuccessful', 'dead', 'classified', 'muscular', 'gradual', 'unresponsiveness', 'azathioprine', 'antipruritic', 'ointment', 'spongy', 'urate', 'alveolus', 'minimum', 'advanced', 'brown', 'circulatory', 'oropharyngeal', 'successful', 'sensitive', 'sterile', 'shiny', 'myelopathy', 'fragile', 'optimize', 'critical', 'coarse', 'daily', 'sensory', 'sedentary', 'alcoholic', 'adrenal', 'comfortable', 'enzymatic', 'wedged', 'hydroxyproline', 'clean', 'late', 'undue', 'pansystolic', 'epiphyseal', 'fibrotic', 'diseased', 'amantadine', 'tonsillar', 'scar', 'anatomic', 'nuclear', 'arytenoid', 'powerful', 'myeloproliferative', 'short', 'neutral', 'smaller', 'fat', 'uneven', 'sinusoid', 'dyspnea', 'cool', 'computed', 'valvular', 'downward', 'precipitate', 'rigid', 'nervous', 'sneeze', 'occluded', 'fatal', 'myocardial', 'moist', 'retinopathy', 'transient', 'stiffness', 'uncontrollable', 'median', 'caliper', 'premature', 'former', 'metabolic', 'dramatic', 'capsule', 'parenteral', 'quantitative', 'underlying', 'nonrespiratory', 'bronchopulmonary', 'disordersšmyocardial', 'abdominal', 'prodromal', 'inappropriate', 'lowest', 'severe', 'correct', 'hepatojugular', 'profound', 'epiglottic', 'preferential', 'earliest', 'stiff', 'apparent', 'greatest', 'vary', 'worse', 'constrictive', 'permanent', 'newer', 'rare', 'traditional', 'occlude', 'metatarsal', 'snug', 'impossible', 'fourth', 'ischemic', 'sputum', 'open', 'australian', 'rapid', 'skilled', 'sarcomatous', 'thready', 'elevated', 'generic', 'relieved', 'progressive', 'labored', 'thigh', 'granulomatous', 'septic', 'dietary', 'upright', 'subdural', 'venous', 'traumatic', 'national', 'restricted', 'ventilatory', 'tiny', 'quiet', 'awake', 'utero', 'cardiomyopathic', 'paroxysmal', 'hard', 'microbiologic', 'independent', 'airœfluid', 'inspiratory', 'unknown', 'dynamic', 'caseous', 'necessary', 'skeletal', 'orthostatic', 'align', 'sudden', 'low', 'tachypnea', 'vagus', 'pelvic', 'intake', 'costal', 'putrid', 'occasional', 'ideal', 'abg', 'efficient', 'preset', 'total', 'well', 'small', 'insidiously', 'first', 'olecranon', 'multisystemic', 'supraglottic', 'reassure', 'vestibular', 'impingement', 'systolic', 'postinfectious', 'mild', 'erythrocyte', 'responsiveness', 'reverse', 'reconstructive', 'pure', 'oversized', 'analgesic', 'secondhand', 'angiographic', 'intellectual', 'fibrous', 'routine', 'rightward', 'readjustment', 'supplementary', 'opportunistic', 'exertional', 'good', 'rough', 'resilient', 'current', 'determined', 'supportive', 'fluoride', 'congenital', 'ovale', 'faster', 'trivial', 'fitting', 'elastic', 'interferes', 'alveolocapillary', 'rug', 'movable', 'laryngeal', 'aware', 'invasive', 'audible', 'posture', 'lethargic', 'infectious', 'nonspecific', 'industrial', 'degenerative', 'humidified', 'prothrombin', 'massive', 'nitroprusside', 'possible', 'flex', 'tibial', 'tympanic', 'mass', 'considerable', 'dorsomedial', 'arterial', 'atmospheric', 'obvious', 'toxic', 'parasternal', 'organic', 'adhesive', 'intersect', 'straight', 'inadequate', 'recent', 'common', 'syncytial', 'scan', 'obese', 'bronchial', 'universal', 'mosenifar', 'lipoprotein', 'diaphragmatic', 'respirable', 'acidotic', 'embolus', 'nonbacterial', 'lumbosacral', 'intact', 'side', 'unused', 'insert', 'prepatellar', 'renal', 'stuporous', 'kailuan', 'tracheobronchial', 'final', 'metacarpal', 'spinous', 'large', 'later', 'easily', 'appropriate', 'male', 'legionella', 'mechanic', 'emphysema', 'viral', 'intestinal', 'flexible', 'tophaceous', 'sharp', 'intercostal', 'aggressive', 'vein', 'maximum', 'significant', 'http', 'plenty', 'sacral', 'visual', 'equal', 'dependent', 'commonlyšand', 'awkward', 'uncertain', 'older', 'onset', 'pedis', 'conjoined', 'balkan', 'cesarean', 'spine', 'cardiomyopathy', 'mycobacterial', 'flare', 'infiltrate', 'immune', 'adolescent', 'drowsiness', 'least', 'nsaid', 'available', 'mediastinal', 'contagious', 'circular', 'deflate', 'cavitary', 'intracavitary', 'subglottic', 'anthracite', 'excess', 'splayed', 'racemic', 'postoperative', 'antipyretic', 'anaerobic', 'adventitious', 'inward', 'tuberculin', 'conservative', 'hypoxic', 'breathe', 'bloodšsuch', 'sternoclavicular', 'epistaxis', 'haziness', 'frequent', 'acute', 'allergic', 'hemovac', 'demonstrate', 'concomitant', 'cancellous', 'supraventricular', 'sagittal', 'terminal', 'unusual', 'noisy', 'antimicrobial', 'bluish', 'interrupt', 'irritable', 'pathologic', 'sesamoid', 'apophyseal', 'focal', 'esophageal', 'benign', 'osteoblastic', 'phrenic', 'limited', 'smooth', 'fungal', 'sciatic', 'valgus', 'fine', 'devastating', 'express', 'biopsy', 'atelectatic', 'uncorrected', 'intravenous', 'prompt', 'tidal', 'weak', 'complete', 'neonatal', 'bloody', 'cartilaginous', 'temporary', 'infant', 'sighing', 'infarcted', 'distant', 'isolated', 'thudlike', 'lymphatic', 'frightening', 'occupational', 'etiologic', 'prevent', 'poor', 'influenza', 'parallel', 'major', 'chronic', 'subarachnoid', 'true', 'new', 'subchondral', 'regular', 'disposable', 'nosebleed', 'unequal', 'subphrenic', 'isometric', 'preschool', 'elder', 'hemophilic', 'tired', 'prolong', 'gentle', 'active', 'continued', 'resident', 'amniotic', 'fundamental', 'orthopedic', 'epiphysitis', 'present', 'european', 'jugular', 'associated', 'diversionary', 'immunosuppressant', 'proteolytic', 'individualized', 'thick', 'intervertebral', 'complex', 'tubular', 'left', 'endoscopic', 'iranian', 'predictable', 'fragment', 'alive', 'parietal', 'postmenopausal', 'percussed', 'congestive', 'perpendicular', 'much', 'strict', 'integral', 'pneumococcal', 'normal', 'reticulonodular', 'hoarseness', 'dispose', 'cooperate', 'hrt', 'surgical', 'uncooperative', 'unconscious', 'high', 'warmer', 'acceptable', 'distal', 'peculiar', 'epiglottitis', 'axial', 'dietitian', 'numbness', 'social', 'pleuritic', 'younger', 'sixth', 'anticholinergic', 'radiologic', 'cardiac', 'increased', 'magnetic', 'chaotic', 'affected', 'anesthetic', 'key', 'gastrointestinal', 'painful', 'nutritious', 'cast', 'insidious', 'immobilized', 'larger', 'peripheral', 'lower', 'sole', 'tough', 'epithelial', 'intrapulmonary', 'likely', 'cylindrical', 'international', 'medullary', 'financial', 'essential', 'sluggishness', 'asymptomatic', 'unnecessary', 'widespread', 'intravascular', 'droplet', 'strenuous', 'artificial', 'public', 'synovial', 'multiple', 'outward', 'osteophyte', 'meticulous', 'accidental', 'top', 'epigastric', 'cns', 'sore', 'moderate', 'orthotist', 'diversional', 'shortened', 'proximal', 'interstitial', 'untreated', 'horizontal', 'rich', 'visceral', 'observe', 'private', 'midline', 'leukocyte', 'greater', 'sufficient', 'columnar', 'excellent', 'giant', 'locate', 'environmental', 'marginal', 'faulty', 'alveolar', 'pulmonary', 'definitive', 'permeable', 'therapeutic', 'balanced', 'inactive', 'gross', 'postnatal', 'urgent', 'unprotected', 'hyperbaric', 'epidural', 'lateral', 'hemorrhagic', 'opposite', 'characterized', 'due', 'erythematous', 'enough', 'nonstriated', 'healthy', 'pagetic', 'relevant', 'duodenum', 'legal', 'parenchymal', 'frequency', 'bronchiolitis', 'mist', 'emotional', 'functional', 'gouty', 'diminished', 'pendulous', 'indicative', 'recumbent', 'burst', 'prominent', 'helpful', 'pathological', 'subsequent', 'removed', 'trochanteric', 'regress', 'acetabular', 'bulbous', 'quiescent', 'transcutaneous', 'prophylactic', 'ceramic', 'single', 'tangled', 'additional', 'herniated', 'infantile', 'palpable', 'inorganic', 'intrauterine', 'axillary', 'intracapsular', 'largest', 'vital', 'pulmonic', 'momentary', 'aortic', 'surfactant', 'principle', 'hepaticšgranulomatous', 'plastic', 'erroneous', 'suprasternal', 'secondary', 'shortness', 'manual', 'back', 'effective', 'symptomatic', 'specific', 'pediatric', 'expensive', 'aerosolized', 'reactive', 'abnormal', 'compressed', 'subcostal', 'potential', 'unrecognized', 'endotracheal', 'treat', 'american', 'irregular', 'cardiopulmonary', 'cycloserine', 'underestimate', 'constant', 'posteriorly', 'responsešsuch', 'intrapleural', 'diuretic', 'different', 'poorest', 'autopsy', 'long', 'occlusive', 'professional', 'unventilated', 'percutaneous', 'paraspinal', 'histologic', 'nocturnal', 'sheath', 'vulnerable', 'vocal', 'alignment', 'aseptic', 'cloudy', 'great', 'black', 'osteoarthritis', 'empty', 'empirical', 'facioscapulohumeral', 'blind', 'infected', 'dull', 'neutrophil', 'restful', 'immotile', 'corticosteroid', 'maculopapular', 'uppermost', 'cultured', 'optimal', 'next', 'susceptible', 'able', 'easy', 'medical', 'ipsilateral', 'overwhelming', 'migratory', 'perinatal', 'future', 'warm', 'hormonal', 'periarticular', 'cerebral', 'noncardiogenic', 'accompanied', 'local', 'developmental', 'recurrent', 'obliterative', 'propel', 'abrupt', 'neurochemical', 'periosteal', 'removal', 'sporadic', 'vascular', 'neuropathy', 'unresolved', 'protective', 'medium', 'patient', 'serosanguineous', 'last', 'bullous', 'gonadal', 'alkaline', 'uncomplicated', 'comprehensive', 'neurovascular', 'tear', 'neoplastic', 'hypnotic', 'markedly', 'bedcover', 'unavailable', 'natriuretic', 'ligamentous', 'permissible', 'stable', 'midaxillary', 'minor', 'difficult', 'cervical', 'variable', 'honeycombing', 'subcutaneous', 'extruded', 'inhaled', 'enteropathy', 'direct', 'bedridden', 'bronchopleural', 'brittle', 'fetal', 'gastric', 'edematous', 'pelvis', 'myoneural', 'mattress', 'milky', 'heberden', 'lobectomy', 'bright', 'unaffected', 'reflex', 'articular', 'nonproductive', 'sign', 'uricosuric', 'pollutant', 'outdoor', 'anesthesiologist', 'adverse', 'anorexia', 'definite', 'supersaturated', 'past', 'persistent', 'noxious', 'crackle', 'femur', 'antispasmodic', 'airborne', 'bacterial', 'annual', 'indistinct', 'mean', 'asterixis', 'fresh', 'croupy', 'obstructive', 'free', 'mosaic', 'malleable', 'deep', 'removable', 'noticeable', 'lymphoid', 'arteriosclerotic', 'closed', 'petal', 'previous', 'corrective', 'gray', 'malignant', 'uncommon', 'sternal', 'flat', 'firstborn', 'structural', 'palsy', 'interior', 'gelatinous', 'idiosyncrasy', 'neural', 'basilar', 'homelessness', 'bottom', 'confirm', 'static', 'endocarditis', 'applicable', 'intensive', 'alert', 'spinal', 'meniscal', 'special', 'tophus', 'copious', 'stressful', 'padded', 'clear', 'wrong', 'connective', 'cachectic', 'cold', 'faisy', 'aged', 'membranous', 'poisonous', 'frontal', 'lumbar', 'mediastinum', 'slow', 'standard', 'joint', 'human', 'nasal', 'atypical', 'fifth', 'better', 'weekly', 'third', 'dextrose', 'skillful', 'central', 'extracellular', 'thorough', 'record', 'general', 'subside', 'conventional', 'symptom', 'neuromuscular', 'tenacious', 'paradoxical', 'eosinophil', 'consequent', 'fluorescent', 'mucous', 'whole', 'prevalent', 'improve', 'peroneal', 'nitrous', 'hemolytic', 'hypoxemic', 'radial', 'lymphadenopathy', 'unaware', 'referral', 'continuous', 'respiratory', 'neonate', 'linear', 'slight', 'longer', 'residual', 'electrical', 'certain', 'amyotrophic', 'orthopaedic', 'inverted', 'instrumental', 'cellular', 'outer', 'overall', 'mandatory', 'cytotoxic', 'ill', 'reserved', 'cooperative', 'hypoalbuminemia', 'intractable', 'shunting', 'elderly', 'nutritional', 'overmedicate', 'nonsurgical', 'tender', 'ventricular', 'maximal', 'peptic', 'transudative', 'hot', 'subperiosteal', 'buttock', 'neurogenic', 'parentœinfant', 'cerebrospinal', 'immunosuppressive', 'saccular', 'mature', 'incomplete', 'neurologic', 'lobular', 'strongest', 'apneic', 'washed', 'subtrochanteric', 'inner', 'substernal', 'microbiological', 'adjacent', 'hyperresonant', 'inotropic', 'front', 'neuroarthropathy', 'radiographic', 'easier', 'bizarre', 'capillary', 'initial', 'posterior', 'mental', 'carbonic', 'underdeveloped', 'fewer', 'aerobic', 'alternate', 'main', 'absent', 'heavy', 'limp', 'yellow', 'medial', 'uninterrupted', 'cranial', 'patellar', 'familial', 'steroid', 'kind', 'upper', 'rickettsial', 'pickwickian', 'overwhelmed', 'recessive', 'narrow', 'destructive', 'positive', 'impulse', 'higher', 'asynchrony', 'basic', 'primary', 'lymphoproliferative', 'loud', 'spastic', 'fluid', 'vertebral', 'epiglottal', 'ancillary', 'embolic', 'compensatory', 'refractory', 'german', 'anticoagulant', 'uncontrolled', 'prescribed', 'osmotic', 'condensate', 'particular', 'light', 'painless', 'gold', 'capacityšnormal', 'external', 'sure', 'depressionšhead', 'probable', 'close', 'hollow', 'atherosclerotic', 'differential', 'exaggerated', 'continual', 'irritant', 'run', 'detailed', 'immediate', 'cyanotic', 'facial', 'ongoing', 'similar', 'immature', 'live', 'seventh', 'undetermined', 'subtle', 'unexplained', 'relative', 'autoimmune', 'atrophic', 'steady', 'turkish', 'multiplied', 'mixed', 'mucopurulent', 'paralyzed', 'underway', 'urinary', 'spasmodic', 'anginal', 'entrapment', 'proliferative', 'shorter', 'partial', 'nontraumatic', 'careful', 'ineffective', 'femoral', 'uptake', 'exact', 'classic', 'prolonged', 'foreign', 'histamine', 'hypertensive', 'soft', 'mycoplasmal', 'characteristic', 'precordial', 'multifactorial', 'squamous', 'reticular', 'pneumomediastinum', 'neoplasm', 'consistent', 'adequate', 'excessive', 'middle', 'mobile', 'retrospective', 'outgrow', 'systemic', 'second', 'turbulent', 'reduced', 'prospective', 'complicated', 'intermediate', 'terminate', 'identifiable', 'patient', 'may', 'disease', 'cause', 'treatment', 'also', 'symptom', 'usually', 'sign', 'diagnosis', 'result', 'pain', 'include', 'pressure', 'lung', 'pulmonary', 'respiratory', 'chest', 'fluid', 'complication', 'change', 'blood', 'infection', 'therapy', 'prevent', 'acute', 'care', 'child', 'level', 'air', 'use', 'severe', 'help', 'used', 'exercise', 'normal', 'incidence', 'pneumonia', 'tissue', 'show', 'chronic', 'failure', 'cast', 'increased', 'monitor', 'hypoxemia', 'produce', 'edema', 'increase', 'space', 'occurs', 'cough', 'alveolar', 'heart', 'pathophysiology', 'sputum', 'provide', 'decreased', 'pneumothorax', 'test', 'special', 'tube', 'condition', 'common', 'surgery', 'secretion', 'fibrosis', 'disorder', 'pa', 'area', 'form', 'cell', 'skin', 'drainage', 'tb', 'year', 'commonly', 'check', 'teach', 'rest', 'watch', 'encourage', 'underlying', 'consideration', 'et', 'early', 'hour', 'family', 'need', 'effusion', 'body', 'drug', 'support', 'rate', 'syndrome', 'requires', 'inflammation', 'abg', 'side', 'infant', 'however', 'upper', 'cor', 'pulmonale', 'ventilator', 'mechanical', 'breath', 'maintain', 'foot', 'day', 'bed', 'parent', 'especially', 'fever', 'culture', 'system', 'within', 'factor', 'amount', 'death', 'movement', 'progress', 'volume', 'one', 'stage', 'report', 'avoid', 'respiration', 'trauma', 'occur', 'atelectasis', 'hand', 'includes', 'weight', 'tendon', 'hypertension', 'le', 'time', 'lead', 'damage', 'causing', 'require', 'activity', 'injury', 'risk', 'mm', 'measure', 'examination', 'nerve', 'stress', 'make', 'al', 'see', 'decrease', 'age', 'hgcase', 'month', 'coughing', 'develops', 'formation', 'without', 'site', 'every', 'reduce', 'relieve', 'effect', 'percussion', 'ordered', 'develop', 'affect', 'loss', 'flow', 'lesion', 'technique', 'exposure', 'gas', 'finding', 'procedure', 'begin', 'wall', 'immediately', 'type', 'response', 'position', 'needed', 'administer', 'control', 'ass', 'increasing', 'although', 'tell', 'output', 'give', 'analysis', 'history', 'often', 'week', 'home', 'perform', 'function', 'typically', 'frequently', 'adult', 'indicate', 'administration', 'explain', 'using', 'suggest', 'called', 'center', 'head', 'people', 'resulting', 'including', 'period', 'feature']

def clean_text_func(text):
    text = str(text)
    text = text.lower()
    # Clean the text
    text = re.sub(r"[^A-Za-z0-9^,!?.\/'+]", " ", text)
    text = re.sub(r"\+", " ", text)
    text = re.sub(r",", " ", text)
    text = re.sub(r"\.", " ", text)
    text = re.sub(r"!", " ", text)
    text = re.sub(r"\?", " ", text)
    text = re.sub(r"'", " ", text)
    text = re.sub(r":", " : ", text)
    text = re.sub(r"\s{2,}", " ", text)
    text = re.sub(r"[0-9]", " ", text)
    final_text = ""
    for x in text.split():
        if x not in domain_stop_word:
            final_text = final_text + x  +" "
    return final_text

df['Disease'] = df['Disease'].apply(lambda x: clean_text_func(x))
df.head()

#%%
X_train = df.Disease
y_train = df.Label


#%%
cv1 = CountVectorizer()
X_train_cv1 = cv1.fit_transform(X_train)
pd_cv1 = pd.DataFrame(X_train_cv1.toarray(), columns=cv1.get_feature_names())

#%%
lr = LogisticRegression()
lr.fit(X_train_cv1, y_train)

#%%
# X_test = "dizziness loss of balance  vomiting tinnitus of hearing in the high frequency range in one ear difficulty focusing your eyes "
X_test = "Difficulty sleeping or staying asleep Fever Fluid draining from ear  Loss of balance. Hearing difficulties. Ear pain"
cleaned_text = clean_text_func(X_test)
#%%
# X_test_cv3  = cv2.transform(X_test)
X_test_cv3  = cv1.transform([cleaned_text])
y_pred_cv3 = lr.predict(X_test_cv3)
print(y_pred_cv3)
